<html>
<head>
<title>Product Network Graph Example</title>
<script type="text/javascript" src="js/jquery-1.8.0.js"></script>
<script type="text/javascript" src="js/d3.v3.js"></script>
<style type="text/css">
/* No style rules here yet */
</style>
</head>
<body>
	<script type="text/javascript">
        var network;
        var w = 500;
        var h = 500;
        var r = 2;
        
        var points = [{name: "Hallie"}, {name: "Chris"}, {name: "Mike"}, {name: "Jim"}];
        var links = [{source: 0, target: 1},
                     {source: 0, target: 2},
                     {source: 0, target: 0}];

        var force = d3.layout.force().nodes(points)
                .links(links).size([ w, h ])
                .linkDistance([ 50 ]).charge([ -100 ])
                .start();

        var colors = d3.scale.category10();

        //Create SVG element
        var svg = d3.select("body")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

        svg.append("svg:defs")
            .append("svg:marker")
            .attr("id", "marker")
            .attr("viewBox","0 -5 10 10")
            .attr("refX", 15)
            .attr("refY",-1.5)
            .attr("markerWidth", 6)
            .attr("markerHeight", 6)
            .attr("orient", "auto")
            .append("svg:path")
            .attr("d","M0,-5L10,0L0,5");

        //Create edges as lines
        /*  var edges = svg.selectAll("path")
                    .data(links)
                    .enter()
                    .append("svg:path")
                    .style("stroke", "#ccc")
                    .style("stroke-width", 1)
                    .style("fill", "none")
                    .attr("name", function(d) {
                        console.log("source: " + d.source);
                        console.log("target: " + d.target);
                        return d.relationship;
                    })
                    .attr("marker-end", function(d) {
                           
                            return "url(#marker)";
                        })
                    .on("click", function() {
                     console.log("click!");
                });  */
                
           var edges = svg.selectAll("line")
                .data(links)
                .enter()
                .append("svg:line")
                .style("stroke", "#ccc")
                .style("stroke-width", 1)
                .style("fill", "none")
                .attr("name", function(d) {
                    console.log("source: " + d.source);
                    console.log("target: " + d.target);
                    return d.relationship;
                })
                .attr("marker-end", function(d) {
                       
                        return "url(#marker)";
                    })
                .on("click", function() {
                 console.log("click!");
            }); 

        $.each(force.links(), function(l) {
            console.log("link: " + l.source + " " + l.target);
        })
        //Create nodes as circles
        var nodes = svg.selectAll("circle").data(
                points).enter().append("circle")
                .attr("r", r).style("fill", function(d, i) {
                    return colors(i);
                }).call(force.drag);

        function tick() {
            nodes.attr(
                    "cx",
                    function(d) {
                        return d.x = Math.max(r, Math.min(w
                                - r, d.x));
                    }).attr(
                    "cy",
                    function(d) {
                        return d.y = Math.max(r, Math.min(h
                                - r, d.y));
                    });
/*              edges
                    .attr(
                            "d",
                            function(d) {
                                var dx = d.target.x
                                        - d.source.x, dy = d.target.y
                                        - d.source.y, dr = Math
                                        .sqrt(dx * dx + dy
                                                * dy);
                                return "M" + d.source.x
                                        + "," + d.source.y
                                        + "A" + dr + ","
                                        + dr + " 0 0,1 "
                                        + d.target.x + ","
                                        + d.target.y;
                            });  */
                edges.attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; }); 

        }

        force.on("tick", tick);

    </script>
</body>
</html>