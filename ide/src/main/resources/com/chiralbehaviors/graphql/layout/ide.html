<!--
 *  Copyright (c) 2015, Facebook, Inc.
 *  All rights reserved.
 *
 *  This source code is licensed under the license found in the
 *  LICENSE file in the root directory of this source tree.
 *
-->
<!DOCTYPE html>
<html>
<head>
<style>
#graphiql {
	height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/graphiql/0.7.1/graphiql.css" />
<script src="http://cdn.jsdelivr.net/fetch/0.9.0/fetch.min.js"></script>
<script src="http://cdn.jsdelivr.net/react/0.14.7/react.min.js"></script>
<script src="http://cdn.jsdelivr.net/react/0.14.7/react-dom.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/graphiql/0.7.1/graphiql.js"></script>
</head>
<body>
	<div id="graphiql">Loading...</div>
	<script>
		var parameters = {};
		var targetURL = "http://graphql-swapi.parseapp.com/";
		
		function setTargetURL(url) {
			targetURL = url;	
		}
		
		function onEditQuery(newQuery) {
			app.onEditQuery(newQuery);
		}
		function onEditVariables(newVariables) {
			app.onEditVariables(newVariables);
		}
		function onEditOperationName(newOperationName) {
			app.onEditOperationName(newOperationName);
		}
		
		function graphQLFetcher(graphQLParams) {
			return fetch(targetURL, {
				method : 'post',
				headers : {
					'Accept' : 'application/json',
					'Content-Type' : 'application/json',
				},
				body : JSON.stringify(graphQLParams),
				credentials : 'include',
			}).then(function(response) {
				return response.text();
			}).then(function(responseBody) {
				try {
					return JSON.parse(responseBody);
				} catch (error) {
					return responseBody;
				}
			});
		}
		
		ReactDOM.render(React.createElement(GraphiQL, {
			fetcher : graphQLFetcher,
			query : parameters.query,
			variables : parameters.variables,
			operationName : parameters.operationName,
			onEditQuery : onEditQuery,
			onEditVariables : onEditVariables,
			onEditOperationName : onEditOperationName
		}), document.getElementById('graphiql'));
	</script>
</body>
</html>