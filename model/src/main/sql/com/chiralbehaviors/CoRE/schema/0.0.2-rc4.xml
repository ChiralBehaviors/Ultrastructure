<?xml version="1.0" encoding="UTF-8"?>

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd"
>
    <include relativeToChangelogFile="true" file="0.0.2-rc1/ruleform/functions" />
    <changeSet id="workspace authorization" author="hhildebrand">
        <createProcedure encoding="utf8" procedureName="null_zero" schemaName="ruleform"><![CDATA[
            CREATE OR REPLACE FUNCTION null_zero(thing anyelement)
              RETURNS integer AS
            $BODY$
            SELECT CASE WHEN $1 IS NULL THEN 0 ELSE 1 END;
            $BODY$
              LANGUAGE sql VOLATILE
              COST 100;
        ]]>
        </createProcedure>
        <createTable schemaName="ruleform" remarks="A workspace authorization defines the entities in a workspace" tableName="workspace_authorization">
            <column name="id" type="uuid">
                <constraints primaryKey="true" primaryKeyName="workspace_authorization_pkey" />
            </column>
            <column name="notes" type="TEXT" />
            <column name="defining_product" type="uuid">
                <constraints nullable="false" />
            </column>
            <column name="type" type="VARCHAR(256)">
                <constraints nullable="false" />
            </column>
            <column name="updated_by" type="uuid">
                <constraints nullable="false" />
            </column>
            <column name="version" type="INT4" />
            <column name="key" type="VARCHAR(1024)" />
            <column name="agency" type="uuid" />
            <column name="agency_attribute" type="uuid" />
            <column name="agency_attribute_authorization" type="uuid" />
            <column name="agency_location" type="uuid" />
            <column name="agency_location_attribute" type="uuid" />
            <column name="agency_network" type="uuid" />
            <column name="agency_network_attribute" type="uuid" />
            <column name="agency_network_authorization" type="uuid" />
            <column name="agency_product" type="uuid" />
            <column name="agency_product_attribute" type="uuid" />
            <column name="attribute" type="uuid" />
            <column name="attribute_meta_attribute" type="uuid" />
            <column name="attr_meta_attr_auth" type="uuid" />
            <column name="attribute_network" type="uuid" />
            <column name="attribute_network_attribute" type="uuid" />
            <column name="unit" type="uuid" />
            <column name="unit_attribute" type="uuid" />
            <column name="unit_attribute_authorization" type="uuid" />
            <column name="unit_network" type="uuid" />
            <column name="unit_network_attribute" type="uuid" />
            <column name="location" type="uuid" />
            <column name="location_attribute" type="uuid" />
            <column name="location_attribute_authorization" type="uuid" />
            <column name="location_network" type="uuid" />
            <column name="location_network_attribute" type="uuid" />
            <column name="location_network_authorization" type="uuid" />
            <column name="product" type="uuid" />
            <column name="product_attribute" type="uuid" />
            <column name="product_attribute_authorization" type="uuid" />
            <column name="product_network" type="uuid" />
            <column name="product_network_attribute" type="uuid" />
            <column name="product_location" type="uuid" />
            <column name="product_location_attribute" type="uuid" />
            <column name="interval" type="uuid" />
            <column name="interval_attribute" type="uuid" />
            <column name="interval_attribute_authorization" type="uuid" />
            <column name="interval_network" type="uuid" />
            <column name="interval_network_attribute" type="uuid" />
            <column name="status_code" type="uuid" />
            <column name="status_code_attribute" type="uuid" />
            <column name="status_code_attribute_authorization" type="uuid" />
            <column name="status_code_network" type="uuid" />
            <column name="status_code_network_attribute" type="uuid" />
            <column name="status_code_sequencing" type="uuid" />
            <column name="job" type="uuid" />
            <column name="job_chronology" type="uuid" />
            <column name="meta_protocol" type="uuid" />
            <column name="network_inference" type="uuid" />
            <column name="product_child_sequencing_authorization" type="uuid" />
            <column name="product_parent_sequencing_authorization" type="uuid" />
            <column name="product_self_sequencing_authorization" type="uuid" />
            <column name="product_sibling_sequencing_authorization" type="uuid" />
            <column name="protocol" type="uuid" />
            <column name="relationship" type="uuid" />
            <column name="relationship_attribute" type="uuid" />
            <column name="relationship_attribute_authorization" type="uuid" />
            <column name="relationship_network" type="uuid" />
            <column name="relationship_network_attribute" type="uuid" />
            <column name="attribute_network_authorization" type="uuid" />
            <column name="interval_network_authorization" type="uuid" />
            <column name="product_network_authorization" type="uuid" />
            <column name="relationship_network_authorization" type="uuid" />
            <column name="status_code_network_authorization" type="uuid" />
            <column name="unit_network_authorization" type="uuid" />
        </createTable>

        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, key," constraintName="workspace_key_constraint"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, agency" constraintName="workspace_unique_ruleform_constraint0"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, agency_attribute" constraintName="workspace_unique_ruleform_constraint1"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, agency_attribute_authorization "
            constraintName="workspace_unique_ruleform_constraint62" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, agency_location" constraintName="workspace_unique_ruleform_constraint2"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, agency_location_attribute"
            constraintName="workspace_unique_ruleform_constraint3" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, agency_network" constraintName="workspace_unique_ruleform_constraint4"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, agency_network_attribute"
            constraintName="workspace_unique_ruleform_constraint5" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, agency_network_attribute"
            constraintName="workspace_unique_ruleform_constraint6" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, agency_network_authorization"
            constraintName="workspace_unique_ruleform_constraint7" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, attribute" constraintName="workspace_unique_ruleform_constraint8"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, attribute_meta_attribute"
            constraintName="workspace_unique_ruleform_constraint9" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, attr_meta_attr_auth" constraintName="workspace_unique_ruleform_constraint10"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, attribute_network" constraintName="workspace_unique_ruleform_constraint11"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, attribute_network_attribute"
            constraintName="workspace_unique_ruleform_constraint12" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, unit" constraintName="workspace_unique_ruleform_constraint13"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, unit_attribute" constraintName="workspace_unique_ruleform_constraint14"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, unit_attribute_authorization"
            constraintName="workspace_unique_ruleform_constraint15" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, unit_network" constraintName="workspace_unique_ruleform_constraint16"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, unit_network_attribute"
            constraintName="workspace_unique_ruleform_constraint17" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, location" constraintName="workspace_unique_ruleform_constraint18"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, location_attribute" constraintName="workspace_unique_ruleform_constraint19"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, location_attribute_authorization"
            constraintName="workspace_unique_ruleform_constraint20" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, location_network" constraintName="workspace_unique_ruleform_constraint21"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, location_network_attribute"
            constraintName="workspace_unique_ruleform_constraint23" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, location_network_authorization "
            constraintName="workspace_unique_ruleform_constraint24" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product" constraintName="workspace_unique_ruleform_constraint25"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_attribute " constraintName="workspace_unique_ruleform_constraint26"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_attribute_authorization"
            constraintName="workspace_unique_ruleform_constraint27" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_network" constraintName="workspace_unique_ruleform_constraint28"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_network_attribute "
            constraintName="workspace_unique_ruleform_constraint29" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_location " constraintName="workspace_unique_ruleform_constraint30"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_location_attribute"
            constraintName="workspace_unique_ruleform_constraint31" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, interval, interval_attribute "
            constraintName="workspace_unique_ruleform_constraint32" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, interval_attribute_authorization"
            constraintName="workspace_unique_ruleform_constraint33" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, interval_network" constraintName="workspace_unique_ruleform_constraint34"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, interval_network_attribute"
            constraintName="workspace_unique_ruleform_constraint35" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, status_code" constraintName="workspace_unique_ruleform_constraint36"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, status_code_attribute" constraintName="workspace_unique_ruleform_constraint37"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, status_code_attribute_authorization"
            constraintName="workspace_unique_ruleform_constraint38" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, status_code_network" constraintName="workspace_unique_ruleform_constraint39"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, status_code_network_attribute"
            constraintName="workspace_unique_ruleform_constraint40" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, status_code_sequencing"
            constraintName="workspace_unique_ruleform_constraint41" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, job" constraintName="workspace_unique_ruleform_constraint42"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, job_chronology" constraintName="workspace_unique_ruleform_constraint43"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, meta_protocol" constraintName="workspace_unique_ruleform_constraint44"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, network_inference" constraintName="workspace_unique_ruleform_constraint45"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_child_sequencing_authorization"
            constraintName="workspace_unique_ruleform_constraint46" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_parent_sequencing_authorization,"
            constraintName="workspace_unique_ruleform_constraint47" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_self_sequencing_authorization"
            constraintName="workspace_unique_ruleform_constraint48" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_sibling_sequencing_authorization"
            constraintName="workspace_unique_ruleform_constraint49" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, protocol" constraintName="workspace_unique_ruleform_constraint50"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, relationship" constraintName="workspace_unique_ruleform_constraint51"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, relationship_attribute"
            constraintName="workspace_unique_ruleform_constraint52" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, relationship_attribute_authorization"
            constraintName="workspace_unique_ruleform_constraint53" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, relationship_network" constraintName="workspace_unique_ruleform_constraint54"
            deferrable="false" disabled="false" initiallyDeferred="true" tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, relationship_network_attribute"
            constraintName="workspace_unique_ruleform_constraint55" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, attribute_network_authorization"
            constraintName="workspace_unique_ruleform_constraint56" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product,interval_network_authorization"
            constraintName="workspace_unique_ruleform_constraint57" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, product_network_authorization"
            constraintName="workspace_unique_ruleform_constraint58" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, relationship_network_authorization"
            constraintName="workspace_unique_ruleform_constraint59" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product, status_code_network_authorization"
            constraintName="workspace_unique_ruleform_constraint60" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />
        <addUniqueConstraint schemaName="ruleform" columnNames="defining_product,unit_network_authorization"
            constraintName="workspace_unique_ruleform_constraint61" deferrable="false" disabled="false" initiallyDeferred="true"
            tableName="workspace_authorization" />

        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="agency" baseTableName="workspace_authorization" constraintName="workspace_authorization_agency_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="agency_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_agency_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="agency_attribute_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_agency_attribute_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency_attribute_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="agency_location" baseTableName="workspace_authorization" constraintName="workspace_authorization_agency_location_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency_location" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="agency_location_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_agency_location_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency_location_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="agency_network" baseTableName="workspace_authorization" constraintName="workspace_authorization_agency_network_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency_network" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="agency_network_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_agency_network_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency_network_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="agency_network_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_agency_network_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency_network_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="agency_product" baseTableName="workspace_authorization" constraintName="workspace_authorization_agency_product_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency_product" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="agency_product_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_agency_product_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency_product_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="attribute_meta_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_attribute_meta_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="attribute_meta_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="attr_meta_attr_auth" baseTableName="workspace_authorization" constraintName="workspace_authorization_attr_meta_attr_auth_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="attr_meta_attr_auth" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="attribute_network" baseTableName="workspace_authorization" constraintName="workspace_authorization_attribute_network_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="attribute_network" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="attribute_network_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_attribute_network_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="attribute_network_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="unit" baseTableName="workspace_authorization" constraintName="workspace_authorization_unit_fkey" deferrable="true"
            initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="unit" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="unit_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_unit_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="unit_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="unit_attribute_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_unit_attribute_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="unit_attribute_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="unit_network" baseTableName="workspace_authorization" constraintName="workspace_authorization_unit_network_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="unit_network" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="unit_network_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_unit_network_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="unit_network_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="location" baseTableName="workspace_authorization" constraintName="workspace_authorization_location_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="location" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="location_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_location_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="location_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="location_attribute_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_location_attribute_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="location_attribute_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="location_network" baseTableName="workspace_authorization" constraintName="workspace_authorization_location_network_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="location_network" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="location_network_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_location_network_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="location_network_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="location_network_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_location_network_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="location_network_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product" baseTableName="workspace_authorization" constraintName="workspace_authorization_product_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="product" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_product_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="product_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_attribute_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_product_attribute_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="product_attribute_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_network" baseTableName="workspace_authorization" constraintName="workspace_authorization_product_network_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="product_network" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_network_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_product_network_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="product_network_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_location" baseTableName="workspace_authorization" constraintName="workspace_authorization_product_location_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="product_location" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_location_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_product_location_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="product_location_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="interval" baseTableName="workspace_authorization" constraintName="workspace_authorization_interval_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="interval" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="interval_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_interval_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="interval_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="interval_attribute_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_interval_attribute_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="interval_attribute_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="interval_network" baseTableName="workspace_authorization" constraintName="workspace_authorization_interval_network_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="interval_network" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="interval_network_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_interval_network_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="interval_network_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="status_code" baseTableName="workspace_authorization" constraintName="workspace_authorization_status_code_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="status_code" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="status_code_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_status_code_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="status_code_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="status_code_attribute_authorization" baseTableName="workspace_authorization"
            constraintName="workspace_authorization_status_code_attribute_authorization_fkey" deferrable="true" initiallyDeferred="true"
            onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="status_code_attribute_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="status_code_network" baseTableName="workspace_authorization" constraintName="workspace_authorization_status_code_network_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="status_code_network" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="status_code_network_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_status_code_network_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="status_code_network_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="status_code_sequencing" baseTableName="workspace_authorization" constraintName="workspace_authorization_status_code_sequencing_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="status_code_sequencing" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="job" baseTableName="workspace_authorization" constraintName="workspace_authorization_job_fkey" deferrable="true"
            initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="job" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="job_chronology" baseTableName="workspace_authorization" constraintName="workspace_authorization_job_chronology_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="job_chronology" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="meta_protocol" baseTableName="workspace_authorization" constraintName="workspace_authorization_meta_protocol_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="meta_protocol" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="network_inference" baseTableName="workspace_authorization" constraintName="workspace_authorization_network_inference_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="network_inference" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_child_sequencing_authorization" baseTableName="workspace_authorization"
            constraintName="workspace_authorization_product_child_sequencing_authorization_fkey" deferrable="true" initiallyDeferred="true"
            onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="product_child_sequencing_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_parent_sequencing_authorization" baseTableName="workspace_authorization"
            constraintName="workspace_authorization_product_parent_sequencing_authorization_fkey" deferrable="true" initiallyDeferred="true"
            onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="product_parent_sequencing_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_self_sequencing_authorization" baseTableName="workspace_authorization"
            constraintName="workspace_authorization_product_self_sequencing_authorization_fkey" deferrable="true" initiallyDeferred="true"
            onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="product_self_sequencing_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_sibling_sequencing_authorization" baseTableName="workspace_authorization"
            constraintName="workspace_authorization_product_sibling_sequencing_authorization_fkey" deferrable="true" initiallyDeferred="true"
            onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="product_sibling_sequencing_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="protocol" baseTableName="workspace_authorization" constraintName="workspace_authorization_protocol_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="protocol" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="relationship" baseTableName="workspace_authorization" constraintName="workspace_authorization_relationship_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="relationship" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="relationship_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_relationship_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="relationship_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="relationship_attribute_authorization" baseTableName="workspace_authorization"
            constraintName="workspace_authorization_relationship_attribute_authorization_fkey" deferrable="true" initiallyDeferred="true"
            onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="relationship_attribute_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="relationship_network" baseTableName="workspace_authorization" constraintName="workspace_authorization_relationship_network_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="relationship_network" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="relationship_network_attribute" baseTableName="workspace_authorization" constraintName="workspace_authorization_relationship_network_attribute_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET NULL" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="relationship_network_attribute" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="updated_by" baseTableName="workspace_authorization" constraintName="workspace_authorization_updated_by_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="SET DEFAULT" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="agency" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="defining_product" baseTableName="workspace_authorization" constraintName="workspace_authorization_defining_product_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="product" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="attribute_network_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_attribute_network_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="attribute_network_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="interval_network_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_interval_network_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="interval_network_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="product_network_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_product_network_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="product_network_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="relationship_network_authorization" baseTableName="workspace_authorization"
            constraintName="workspace_authorization_relationship_network_authorization_fkey" deferrable="true" initiallyDeferred="true"
            onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="relationship_network_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="status_code_network_authorization" baseTableName="workspace_authorization"
            constraintName="workspace_authorization_status_code_network_authorization_fkey" deferrable="true" initiallyDeferred="true"
            onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="status_code_network_authorization" />
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="unit_network_authorization" baseTableName="workspace_authorization" constraintName="workspace_authorization_unit_network_authorization_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id"
            referencedTableName="unit_network_authorization" />

        <createIndex schemaName="ruleform" indexName="workspace_authorization_updated_by_fkey_idx" tableName="workspace_authorization"
            unique="false"
        >
            <column name="updated_by" />
        </createIndex>
        <createIndex schemaName="ruleform" indexName="workspace_authorization_defining_product_fkey_idx" tableName="workspace_authorization"
            unique="false"
        >
            <column name="defining_product" />
        </createIndex>
        <createIndex schemaName="ruleform" indexName="workspace_authorization_key_idx" tableName="workspace_authorization"
            unique="false"
        >
            <column name="updated_by" />
        </createIndex>
        <createIndex schemaName="ruleform" indexName="workspace_authorization_type_idx" tableName="workspace_authorization"
            unique="false"
        >
            <column name="type" />
        </createIndex>
        <sql><![CDATA[
            ALTER TABLE ruleform.workspace_authorization ADD CONSTRAINT
            wsa_single_reference CHECK((
                ruleform.null_zero(agency) +
                ruleform.null_zero(agency_attribute) +
                ruleform.null_zero(agency_attribute_authorization) +
                ruleform.null_zero(agency_location) +
                ruleform.null_zero(agency_location_attribute) +
                ruleform.null_zero(agency_network) +
                ruleform.null_zero(agency_network_attribute) +
                ruleform.null_zero(agency_network_authorization) +
                ruleform.null_zero(agency_product) +
                ruleform.null_zero(agency_product_attribute) +
                ruleform.null_zero(attribute) +
                ruleform.null_zero(attribute_meta_attribute) +
                ruleform.null_zero(attr_meta_attr_auth) +
                ruleform.null_zero(attribute_network) +
                ruleform.null_zero(attribute_network_attribute) +
                ruleform.null_zero(attribute_network_authorization) +
                ruleform.null_zero(unit) +
                ruleform.null_zero(unit_attribute) +
                ruleform.null_zero(unit_attribute_authorization) +
                ruleform.null_zero(unit_network) +
                ruleform.null_zero(unit_network_attribute) +
                ruleform.null_zero(unit_network_authorization) +
                ruleform.null_zero(location) +
                ruleform.null_zero(location_attribute) +
                ruleform.null_zero(location_attribute_authorization) +
                ruleform.null_zero(location_network) +
                ruleform.null_zero(location_network_attribute) +
                ruleform.null_zero(location_network_authorization) +
                ruleform.null_zero(product) +
                ruleform.null_zero(product_attribute) +
                ruleform.null_zero(product_attribute_authorization) +
                ruleform.null_zero(product_network) +
                ruleform.null_zero(product_network_attribute) +
                ruleform.null_zero(product_network_authorization) +
                ruleform.null_zero(product_location) +
                ruleform.null_zero(product_location_attribute) +
                ruleform.null_zero(interval) +
                ruleform.null_zero(interval_attribute) +
                ruleform.null_zero(interval_attribute_authorization) +
                ruleform.null_zero(interval_network) +
                ruleform.null_zero(interval_network_attribute) +
                ruleform.null_zero(interval_network_authorization) +
                ruleform.null_zero(status_code) +
                ruleform.null_zero(status_code_attribute) +
                ruleform.null_zero(status_code_attribute_authorization) +
                ruleform.null_zero(status_code_network) +
                ruleform.null_zero(status_code_network_attribute) +
                ruleform.null_zero(status_code_network_authorization) +
                ruleform.null_zero(status_code_sequencing) +
                ruleform.null_zero(job) +
                ruleform.null_zero(job_chronology) +
                ruleform.null_zero(meta_protocol) +
                ruleform.null_zero(network_inference) +
                ruleform.null_zero(product_child_sequencing_authorization) +
                ruleform.null_zero(product_parent_sequencing_authorization) +
                ruleform.null_zero(product_self_sequencing_authorization) +
                ruleform.null_zero(product_sibling_sequencing_authorization) +
                ruleform.null_zero(protocol) +
                ruleform.null_zero(relationship) +
                ruleform.null_zero(relationship_attribute) +
                ruleform.null_zero(relationship_attribute_authorization) +
                ruleform.null_zero(relationship_network) +
                ruleform.null_zero(relationship_network_authorization)
                ) = 1)
        ]]>
        </sql>
    </changeSet>
    <changeSet id="Job depth limit" author="hhildebrand">
        <addColumn tableName="job" schemaName="ruleform">
            <column name="depth" type="SMALLINT" />
        </addColumn>
        <createView viewName="job" schemaName="readable" replaceIfExists="true"><![CDATA[
             SELECT base_table.id, 
                    base_table.depth,
                    s.name AS service, 
                    r.name AS requester, 
                    p.name AS product,  
                    dt.name AS deliver_to, 
                    df.name AS deliver_from, 
                    at.name AS assign_to,
                    sc.name AS status, 
                    base_table.quantity,
                    u.name AS quantity_unit,
                    base_table.parent, 
                    ra.name AS requester_attribute,
                    sa.name AS service_attribute,
                    pa.name AS product_attribute,
                    dta.name AS deliver_to_attribute,
                    dfa.name AS deliver_from_attribute,
                    ata.name AS assign_to_attribute,
                    base_table.sequence_number,
                    base_table.notes, 
                    base_table.current_log_sequence,
                    up.name AS updated_by, base_table.version,
                    base_table.protocol
               FROM job base_table
               JOIN product s ON base_table.service = s.id
               JOIN product p ON base_table.product = p.id
               JOIN agency at ON base_table.assign_to = at.id
               JOIN agency r ON base_table.requester = r.id
               JOIN location dt ON base_table.deliver_to = dt.id
               JOIN location df ON base_table.deliver_from = df.id
               JOIN status_code sc ON base_table.status = sc.id
               JOIN agency up ON base_table.updated_by = up.id
               JOIN attribute ra ON base_table.requester_attribute = ra.id
               JOIN attribute sa ON base_table.service_attribute = sa.id
               JOIN attribute pa ON base_table.product_attribute = pa.id
               JOIN attribute dta ON base_table.deliver_to_attribute = dta.id
               JOIN attribute dfa ON base_table.deliver_from_attribute = dfa.id
               JOIN unit u ON base_table.quantity_unit = u.id
               JOIN attribute ata ON base_table.assign_to_attribute = ata.id;
        ]]>
        </createView>

        <addColumn tableName="protocol" schemaName="ruleform">
            <column name="children_relationship" type="uuid">
                <constraints nullable=" false " />
            </column>
        </addColumn>
        <addForeignKeyConstraint baseTableSchemaName="ruleform " referencedTableSchemaName="ruleform"
            baseColumnNames="children_relationship" baseTableName="protocol" constraintName="protocol_children_relationship_fkey"
            deferrable="true" initiallyDeferred="true" onDelete="CASCADE" onUpdate="CASCADE" referencedColumnNames="id" referencedTableName="relationship" />
        <createView viewName="protocol" schemaName="readable" replaceIfExists="true"><![CDATA[
             SELECT base_table.id,
                base_table.name,
                s.name AS service,
                p.name AS product,
                r.name AS requester,
                dt.name AS deliver_to,
                df.name AS deliver_from,
                assign.name AS assign_to,
                base_table.quantity,
                u.name AS quantity_unit,
                ra.name AS requester_attribute,
                sa.name AS service_attribute,
                pa.name AS product_attribute,
                dta.name AS deliver_to_attribute,
                dfa.name AS deliver_from_attribute,
                ata.name AS assign_to_attribute,
                cs.name AS child_service,
                cp.name AS child_product,
                cr.name AS children_relationship,
                cat.name AS child_assign_to,
                base_table.child_quantity,
                cqu.name AS child_quantity_unit,
                cdt.name AS child_deliver_to,
                cdf.name AS child_deliver_from,
                csa.name AS child_service_attribute,
                cpa.name AS child_product_attribute,
                cdta.name AS child_deliver_to_attribute,
                cdfa.name AS child_deliver_from_attribute,
                cata.name AS child_assign_to_attribute,
                base_table.sequence_number,
                base_table.notes,
                up.name AS updated_by,
                base_table.version
               FROM ruleform.protocol base_table
               JOIN ruleform.product s ON base_table.service = s.id
               JOIN ruleform.product p ON base_table.product = p.id
               JOIN ruleform.agency r ON base_table.requester = r.id
               JOIN ruleform.location dt ON base_table.deliver_to = dt.id
               JOIN ruleform.location df ON base_table.deliver_from = df.id
               JOIN ruleform.agency assign ON base_table.assign_to = assign.id
               JOIN ruleform.unit u ON base_table.quantity_unit = u.id
               JOIN ruleform.unit cqu ON base_table.child_quantity_unit = cqu.id
               JOIN ruleform.attribute ra ON base_table.requester_attribute = ra.id
               JOIN ruleform.attribute sa ON base_table.service_attribute = sa.id
               JOIN ruleform.attribute pa ON base_table.product_attribute = pa.id
               JOIN ruleform.attribute dta ON base_table.deliver_to_attribute = dta.id
               JOIN ruleform.attribute dfa ON base_table.deliver_from_attribute = dfa.id
               JOIN ruleform.attribute ata ON base_table.assign_to_attribute = ata.id
               JOIN ruleform.product cs ON base_table.child_service = cs.id
               JOIN ruleform.product cp ON base_table.child_product = cp.id
               JOIN ruleform.relationship cr ON base_table.children_relationship = cr.id
               JOIN ruleform.agency cat ON base_table.child_assign_to = cat.id
               JOIN ruleform.location cdt ON base_table.child_deliver_to = cdt.id
               JOIN ruleform.location cdf ON base_table.child_deliver_from = cdf.id
               JOIN ruleform.attribute csa ON base_table.child_service_attribute = csa.id
               JOIN ruleform.attribute cpa ON base_table.child_product_attribute = cpa.id
               JOIN ruleform.attribute cdta ON base_table.child_deliver_to_attribute = cdta.id
               JOIN ruleform.attribute cdfa ON base_table.child_deliver_from_attribute = cdfa.id
               JOIN ruleform.attribute cata ON base_table.child_assign_to_attribute = cata.id
               JOIN ruleform.agency up ON base_table.updated_by = up.id;
        ]]>
        </createView>
    </changeSet>
</databaseChangeLog>